version: 2.1

setup: true

orbs: 
  continuation: circleci/continuation@0.2.0

parameters:
  python-version:
    type: string
    default: '3.8'
    
jobs:
  init:
    docker:
      - image: cimg/python:<< pipeline.parameters.python-version >>
    steps:
      - checkout
      - run:
          name: set up parameters
          command: |
            jq --null-input --argjson parallelism 2 '{"parallelism": $parallelism}' > params.json
      - continuation/continue:
          configuration_path: .circleci/continued.yml
          parameters: params.json

workflows:
  # NOTE: there can only be 1 workflow here.
  # This is known as the "setup workflow" then.
  setup:
    jobs:
      - init
